<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mia's Sugar - Carta Digital</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background-color: #fce4ec; margin: 0; padding: 0; color: #333; }
        header { background-color: #ad1457; color: white; text-align: center; padding: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .container { padding: 15px; max-width: 600px; margin: auto; }
        .seccion { background: white; border-radius: 15px; padding: 15px; margin-bottom: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        h2 { color: #ad1457; border-bottom: 2px solid #f8bbd0; padding-bottom: 5px; }
        .btn-mesa { padding: 10px 5px; border-radius: 8px; background: white; border: 1px solid #ddd; font-weight: bold; cursor: pointer; }
        .grid-mesas { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-top: 10px; }
        .producto { display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid #eee; }
        .btn-a√±adir { background-color: #ad1457; color: white; border: none; padding: 8px 15px; border-radius: 20px; cursor: pointer; }
        .cesta { background: #fff; padding: 20px; border-top: 3px solid #ad1457; position: sticky; bottom: 0; }
        .aviso-error { background-color: #FFF9C4; border: 2px solid #FBC02D; border-radius: 12px; padding: 15px; margin: 15px 0; text-align: center; }
        .btn-pedir { background-color: #4caf50; color: white; border: none; width: 100%; padding: 15px; font-size: 1.2em; border-radius: 10px; font-weight: bold; cursor: pointer; }
        .oculto { display: none; }
    </style>
</head>
<body>

<header>
    <h1> Mia's Sugar </h1>
    <p>Pasteler√≠a & Caf√©</p>
</header>

<div class="container">
    <div id="seccion-ubicacion" class="seccion">
        <h2 style="text-align: center;">¬øD√≥nde est√°s sentado?</h2>
        
        <h3 style="color: #2e7d32;">üçÄ TERRAZA (15 Mesas)</h3>
        <div class="grid-mesas">
            <script>
                for (let i = 1; i <= 15; i++) {
                    document.write(`<button class="btn-mesa" onclick="seleccionarMesa('Terraza - Mesa ${i}', this)">Mesa ${i}</button>`);
                }
            </script>
        </div>

        <h3 style="color: #ef6c00; margin-top: 20px;">üõãÔ∏è SALONCITO (7 Mesas)</h3>
        <div class="grid-mesas">
            <script>
                for (let i = 1; i <= 7; i++) {
                    document.write(`<button class="btn-mesa" onclick="seleccionarMesa('Saloncito - Mesa ${i}', this)">Mesa ${i}</button>`);
                }
            </script>
        </div>
    </div>

    <div id="menu-productos" class="oculto">
        <div class="seccion">
            <h2>‚òï Caf√©s y Bebidas</h2>
            <div class="producto"><span>Mia Sugar Cafe (5‚Ç¨)</span> <button class="btn-a√±adir" onclick="a√±adir('Mia Sugar Cafe', 5)">A√±adir</button></div>
            <div class="producto"><span>Caf√© Nutella (3‚Ç¨)</span> <button class="btn-a√±adir" onclick="a√±adir('Cafe Nutella', 3)">A√±adir</button></div>
            <div class="producto"><span>Frapp√© (4.50‚Ç¨)</span> <button class="btn-a√±adir" onclick="a√±adir('Frappe', 4.5)">A√±adir</button></div>
        </div>

        <div class="seccion">
            <h2>ü•™ Salados</h2>
            <div class="producto"><span>York + Queso (5‚Ç¨)</span> <button class="btn-a√±adir" onclick="a√±adir('York + Queso', 5)">A√±adir</button></div>
            <div class="producto"><span>Especial Pistacho (7‚Ç¨)</span> <button class="btn-a√±adir" onclick="a√±adir('Especial Pistacho', 7)">A√±adir</button></div>
        </div>

        <div class="aviso-error">
            <p style="margin: 0; color: #5D4037; font-weight: bold;">‚ö†Ô∏è ¬°Atenci√≥n!</p>
            <p style="margin: 5px 0 0 0; color: #795548; font-size: 0.9em;">Si te has equivocado en tu comanda, por favor, <b>avisa inmediatamente a cocina</b>.</p>
        </div>

        <div class="cesta">
            <h3>Tu Pedido (<span id="mesa-seleccionada">...</span>)</h3>
            <div id="lista-cesta"></div>
            <p><strong>Total: <span id="total">0.00</span>‚Ç¨</strong></p>
            <button class="btn-pedir" onclick="enviarPedido()">üöÄ ENVIAR A COCINA</button>
        </div>
    </div>
</div>

<script>
    // CONFIGURACI√ìN FIREBASE
    const firebaseConfig = { databaseURL: "https://mia-s-sugar-default-rtdb.europe-west1.firebasedatabase.app" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let ubicacionActual = "";
    let cesta = [];

    function seleccionarMesa(nombre, boton) {
        ubicacionActual = nombre;
        document.getElementById('mesa-seleccionada').innerText = nombre;
        document.getElementById('menu-productos').classList.remove('oculto');
        // Marcar bot√≥n seleccionado
        document.querySelectorAll('.btn-mesa').forEach(b => b.style.background = "white");
        boton.style.background = "#f8bbd0";
        window.scrollTo({ top: document.getElementById('menu-productos').offsetTop, behavior: 'smooth' });
    }

    function a√±adir(nombre, precio) {
        cesta.push(nombre);
        actualizarCesta();
    }

    function actualizarCesta() {
        const lista = document.getElementById('lista-cesta');
        lista.innerHTML = cesta.map(p => `<div>‚Ä¢ ${p}</div>`).join('');
        let total = cesta.length > 0 ? cesta.length * 5 : 0; // Ejemplo simple de c√°lculo
        document.getElementById('total').innerText = (cesta.length * 5).toFixed(2); // Ajustar seg√∫n precios reales
    }

    function enviarPedido() {
        if (cesta.length === 0) return alert("La cesta est√° vac√≠a");
        
        const nuevoPedido = {
            ubicacion: ubicacionActual,
            productos: cesta,
            estado: "Nuevo",
            hora: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})
        };

        db.ref('pedidos').push(nuevoPedido).then(() => {
            alert("¬°Pedido enviado con √©xito! üëç");
            cesta = [];
            actualizarCesta();
            location.reload();
        });
    }
</script>

</body>
</html>
